## 学习总结

### 区块链简明发展史

#### 比特币

基于p2p网络的 电子现金系统的设计， 而系统中产生和流通的就是比特币

比特币网络主要目的是存储该电子现金系统里所有账户的转账交易 并确保这些交易记录无法被篡改

比特币网络的功能仅限于让用户进行财务交易



**总结：**

1. 比特币是基于P2P网络设计的电子现金系统中 产生和流通的货币
2. 比特币网络主要目的是存储该系统中的所有账户转账交易，并确保这些记录无法被篡改
3. 比特币网络的功能 仅限于让用户进行财务交易

#### 以太坊

由于比特币网络仅限于进行财务交易，于是V神提出，基于比特币中的区块链技术创建更加复杂的去**去中心化应用(DAPP)**，典型去中心化应用

+ 基于以太坊创建新的加密货币(ICO)
+ 基于以太坊创建域名注册系统 博彩系统
+ 基于以太坊开发去中心的游戏

这些应用都要依赖于以太坊内建的**智能合约**

以太坊发行代币融资

**ICO：**基于以太坊智能合约可以方便的发行遵循ERC20规范的数字货币， 这个过程被称呼为首次代币发行(ICO), 

缺点：因为去中心化不受监管，项目方拿到筹集的以太坊随便花，投资方拿到代币后对项目运作和资金开销没有约束(我发行一种代币，你用以太坊来换)

**DAICO：**发行代币募集来的资金被智能合约锁定在账户里，区块链创业团队在资金支出时提出请求，多数投资者统一后才可以被花出去



**总结：**

1. 以太坊基于区块链基础创建更加复杂的去中心化应用
2. 基于以太坊的应用有很多，创建新的加密货币融资就是一种



### 区块链的核心概念和原理

#### 账户 交易 区块 区块链

+ **账户(Account)：**以太坊的账户由 地址 公钥 私钥 组成
+ **交易(Transaction)：**在区块链中可以指两个账户之间的**转账交易** 或者 **智能合约调用请求**
+ **区块(Block):**区块链中的每个区块都包含多笔交易
+ **区块链(Blockchain):**多个区块被矿工打包组成的一个链

**区块链是啥子：**分布式 去中心化 不可被篡改的 缓慢数据库



#### 块高度  出快时间

**块高度：** 表示当前区块链的区块的个数

**出块时间：**表示区块链上相邻的两个区块产生出来的时间间隔， 或者说 交易确认时间，  比特币区块时间控制在10分钟， 而以太坊区块时间为15秒

#### 为啥出块时间要这么长?

因为存在的**共识机制**， 共识机制是用来保证区块信息在全网节点中保持一致共识的机制，常用的共识算法有**POW, POS,DPOS**

##### POW 工作量证明机制

通过算力比拼来选取一个节点，由该节点确定下一轮共识的区块内容(记账权)

POW要求节点消耗自身算力尝试不同的随机数(nonce),从而寻找符合算力难度要求的哈希值， 这个过程就是挖矿

第一个找到合适的nonce的节点获得记账权，**节点生成新区块后广播给其他节点，其他节点进行验证，若通过验证则接受该区块，完成本轮共识， 否则拒绝该区块，继续寻找合适的nonce**

扩展： 双花攻击 最长链原则 算力超过51% 修改 51%数据达到最长链

##### POS权益证明机制

节点争夺记账权依靠的不是算力而是权益(代币)，POS也需要计算哈希值，但不需要之前的暴力计算寻找nonce值

每个节点每一轮共识只需要计算一次哈希值，当拥有的权益越多，计算得到满足哈希目标的机会就越大，获得记账权的越大

权益除了与代币数量有关 还和 币龄有关 ，持有的代币数量越多，时间越长 获得记账权机会越大

##### DPOS 委托权益证明机制

持币用户通过抵押代币获得选票，以投票的方式选出若干节点作为区块生产者，将去生产区块委托给有能力胜任的抓也人员，最后享受参与出块的奖励

以EOS为代表选出21个节点，在每一轮的共识中 轮流 选出一位出块节点产生区块， 并广播给其他出块节点进行验证， 若节点无法在规定时间完成出块 会被取消资格，取而代之是重新投票选出新的出块节点

EOS初期也是才用最长链共识， 意味着和POW 一样没有绝对最终性，交易的不可逆需要等待多个区块确定， 于是18年使用拜占庭共识代替最长链共识

### 以太坊核心概念和原理

#### 以太坊网络

**整体：**以太坊网络本质是p2p网络，其用途是用来 发起交易 存储交易历史，以太坊的交易指 转账和调用智能合约中的方法， 而以太坊区块链就是存储整个以太坊网络上的交易记录

**个体：**p2p网络有多个节点，每个节点都允许以太坊客户端，而任何人都可以运行以太坊节点，每个节点上都包含以太坊区块链数据库的整体副本， 每个节点都能接受RPC交易请求并将请求广播给其他节点，每个节点都可以尝试进行交易打包(挖矿)



#### 如何与以太坊网络交互

与以太坊进行交互指的就是 发起 读取或修改 以太坊区块链上数据的请求，并拿到反馈



#### 智能合约

**智能合约只得是以太坊网络上被代码控制的一个账户**，一般叫做内部账户，而 其他账户则可以通过 交易 与智能合约账户进行交易

**智能合约源码与智能合约账户区别**

同一个智能合约源码部署在不同的网络或同一网络，都会产生不同的智能合约地址



**智能合约关键属性**

每一个智能合约都有一下几个关键属性

+ **balance:** 该智能合约能够控制的资产余额
+ **storage:** 智能合约相关数据会存储在这里
+ **code:** 智能合约的字节码



#### 深入理解以太坊中的交易

一个交易完成后的详细信息包括

+ TxHash: 交易流水号
+ Block Height: 这笔交易被打包后进去的区块编号
+ From/To/Value: 说明交易发起账户，接受账户，转账金额，如果智能合约调用也有这三个字段，但会说明调用的函数
+ Gas Limit/Used/Price 和 Actual Tx Cost， 交易手续费
  + Gas Limit， 设置交易能给的最大消耗汽油
  + Gas Used,  实际消耗的汽油
  + Gas Price, 表示每个汽油的价格
  + Actual ..,  实际花了多少钱

合理的参数

[Gas Limit]([etherscan.io/chart/gasli…](https://link.juejin.cn/?target=https%3A%2F%2Fetherscan.io%2Fchart%2Fgaslimit))

[Gas Price]([etherscan.io/chart/gaspr…](https://link.juejin.cn/?target=https%3A%2F%2Fetherscan.io%2Fchart%2Fgasprice))



### Solidity 介绍

#### Solidity源码到智能合约的过程

+ 用Solidity编写的源码，需要先使用编译器编译为字节码(Bytecode), 编译过程中会同时产生只能合约的二进制接口规范(ABI)
+ 通过交易(Transaction)的方式将字节码部署到以太坊网络，每次成功的部署都会产生一个新的智能合约

而使用Javascript编写的DApp通常 通过 web3.js + API 去调用智能合约中的函数来实现数据的读取和修改





